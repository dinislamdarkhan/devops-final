# This is a basic workflow to help you get started with Actions

name: CI

# Controls when the workflow will run
on:
  # Triggers the workflow on push or pull request events but only for the "main" branch
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  deploy:
    # The type of runner that the job will run on
    runs-on: ubuntu-latest

    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:
      - name: 'Create env file'
        run: |
          echo "${{ secrets.PEM_TEXT }}" > dinislam.pem
      - name: Execute Ansible Playbook
        # You may pin to the exact commit or the version.
        # uses: saubermacherag/ansible-playbook-docker-action@6504ab82647581a928477ecb9c6d52f11fc6843f
        uses: saubermacherag/ansible-playbook-docker-action@v1.4
        with:
          # Name of the playbook in your workspace.
          playbookName: /ansible/playbook-dinislam.yml
          # Name of the inventory file to use.
          inventoryFile: /ansible/inventory
          # name of the requirements file to use.
          keyFile: dinislam.pem
